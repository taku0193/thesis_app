<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Thetis Templates Browser</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="bg-shape shape-1"></div>
    <div class="bg-shape shape-2"></div>
    <main class="stage">
      <section class="panel camera-panel">
        <div class="panel-header">
          <h2>Live Session</h2>
          <div class="session-meta">
            <div class="session-timer">
              <span id="session-time">30:00</span>
              <div class="session-bar">
                <div id="session-fill" class="session-fill"></div>
              </div>
            </div>
            <div id="heart-badge" class="heart-badge">❤ -- bpm</div>
          </div>
        </div>
        <div class="camera-frame">
          <video id="camera-video" autoplay playsinline muted></video>
          <canvas id="overlay-canvas"></canvas>
        </div>
        <div id="minute-score" class="minute-score">1分スコア: --</div>
        <div id="exercise-alert" class="exercise-alert">次の種目へ！</div>
        <div id="cheer-message" class="cheer-message">さあ、はじめよう！</div>
        <div id="bgm-loading" class="bgm-loading">BGM生成中…</div>
        <div id="session-summary" class="session-summary">
          <div class="summary-title">Session Summary</div>
          <div class="summary-grid">
            <div>Avg Score</div>
            <div id="summary-score">--</div>
            <div>Best Score</div>
            <div id="summary-best">--</div>
            <div>Avg BPM</div>
            <div id="summary-bpm">--</div>
            <div>Peak BPM</div>
            <div id="summary-peak">--</div>
            <div>Duration</div>
            <div id="summary-duration">--</div>
          </div>
        </div>
        <div class="input-row">
          <label>
            Genre:
            <input id="music-genre" type="text" placeholder="hiphop, house, pop" />
          </label>
          <label>
            Duration (s):
            <input id="duration" type="number" value="30" min="5" step="1" disabled />
          </label>
          <button id="start-camera" class="ghost">Start Camera</button>
          <button id="end-session" class="ghost">End Session</button>
          <button id="auto-toggle" class="primary">Auto: On</button>
        </div>
      </section>

      <section class="panel template-panel">
        <div class="panel-header">
          <div>
            <h2 id="exercise-title">Loading...</h2>
            <p id="exercise-meta" class="muted"></p>
          </div>
          <button id="shuffle-btn" class="primary">Shuffle</button>
        </div>
        <div class="template-frame">
          <video id="template-video" class="template-video" loop muted playsinline></video>
        </div>
        <div class="feedback-row">
          <div id="judgement" class="judge-badge">Bad</div>
          <div id="feedback" class="muted">左足首の位置がずれているかも？</div>
        </div>
        <div class="score-row">
          <div class="score-label">Match</div>
          <div class="score-bar">
            <div id="score-fill" class="score-fill"></div>
          </div>
          <div id="score-value" class="score-value">--</div>
        </div>
        <div id="metrics" class="metrics-grid"></div>
        <div class="asset-links" id="asset-links"></div>
      </section>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/pose@0.5/pose.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/face_mesh@0.5/face_mesh.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils@0.3/camera_utils.js"></script>
    <script src="app.js"></script>
  </body>
</html>
